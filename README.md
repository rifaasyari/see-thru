# See-Thru

### This repo contains the tools needed to create a neural network capable of pose estimation from radar images. Specifically, the programs use the [Walabot Creator](https://walabot.com/makers) radar.

## Setup

* Install the [WalabotSDK](https://walabot.com/getting-started) and Walabot Python library (see [python api](https://api.walabot.com/_pythonapi.html)).
* Install pip dependencies.

## Usage

* For data collection use `measure.py`
* For dataset generation use `generate_dataset.py`
* For data exploration use `explorer.py`
* For model training use `train.py`
* For model deployment use `seethru.py`

During training models are saved into their seperate subdirectories in the nets folder. Select the wanted model, remove the timestamp from its filename and place it into the nets parent folder. (Like: `/nets/seethru.pth`)

<img width=512px src="res/app.png">

## Data Collection

### Hardware Used

* Camera

    Ausdom AF640
    > Resolution: 1080p (running at 640 x 480) <br>
    > FOV: 90Â°

* Radar
    
    Vayyar Walabot Creator
    > Antennas: 15 <br>
    > Board size: 72 mm * 140 mm <br>
    > Frequency range: 6.3 - 8 GHz

### Experiment setup

<img width=512px src="res/setup_1.png">

<img width=512px src="res/setup_2.png">

### Storage

Camera and radar images are stored in png form.

## Data Processing

### Pose Recognition

The posed detection model of choice is [MediaPipe Pose](https://google.github.io/mediapipe/solutions/pose.html). Unnecessary keypoints are discarded, so we end up with 13 keypoints. Theese keypoints are the outputs of the model.

A way to improve collected data is to fill in the blank keypoints with ones generated by a nearual network. This is not a hard task, as there is no need to collect new data (altough getting more data always leads to better results). We can process the already collected keypoints by filtering out random keypoints to train a keypoint prediction supplementary neural network. See the implementation of this in `supplement_poses.py`.

Measured keypoints | Keypoint supplementation
:---: | :---:
<img width=256px src="res/pose.png"> | <img width=256px src="res/pose_predict.png">

## Modeling

To get a neural network that improves over time, we needed to find a loss function that determines how accurate a prediction is. Here N is the number of predicted keypoints, Rx and Ry are vectors of real keypoints and Px and Py are vectors of predicted keypoints.

<img width=512px src="res/loss_function.png">